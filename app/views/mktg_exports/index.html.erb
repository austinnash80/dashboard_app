
<h1 class="text-center"><%= params['co'].present? ? params['co'].titlecase : ''%> MKTG Exports</h1>
<% if params['co'].present? == false %>
<p class="text-center"><%= link_to 'Empire', mktg_exports_path(co: 'empire', delete: 'yes'), class: "btn btn-primary text-light mt-2 w200" %> <%= link_to 'Sequoia', mktg_exports_path(co: 'sequoia', delete: 'yes'), class: "btn btn-primary text-light mt-2 w200" %></p>
<% elsif params['co'] == 'sequoia' %>
<p class="text-center"><%= link_to 'Switch to Empire', mktg_exports_path(co: 'empire', delete: 'yes'), class: "btn btn-primary text-light mt-2 w200" %></p>
<% elsif params['co'] == 'empire' %>
<p class="text-center"><%= link_to 'Switch to Sequoia', mktg_exports_path(co: 'sequoia', delete: 'yes'), class: "btn btn-primary text-light mt-2 w200" %></p>
<% end %>

<p id="notice" class="text-center fw-bold"><%= notice %></p>

<!-- UPLOAD, DELETE, EXPORT, PRINT -->
  <p class="fs-4">Upload New List</p>
    <%= form_tag import_mktg_exports_path, multipart: true do %>
    <%= file_field_tag :file, class: 'btn btn-sm btn-light' %>
    <%= submit_tag 'Upload', class: 'btn btn-sm btn-primary text-light' %>
  <% end %>

  <% if params['remove_all'] == 'yes' %>
    <p><%= link_to "Confirm Delete", mktg_exports_path(remove_all: 'yes', confirm: 'yes'), class: 'btn btn-sm btn-danger mt-4 w200' %></p>
  <% else %>
    <p><%= link_to "Remove All Records", mktg_exports_path(remove_all: 'yes'), class: 'btn btn-sm btn-warning mt-4 w200' %></p>
  <% end %>

  <p><%= link_to 'Export List (csv)', mktg_exports_path('csv'), class: 'btn btn-sm btn-secondary text-light mt-2 w200' %></p>
  <p><%= link_to 'Print', print_mktg_exports_path, class: 'btn btn-sm btn-success text-light mt-2 w200', target: '_blank' %></p>
<!-- END UPLOAD, DELETE, EXPORT, PRINT -->

<div class="m-5">
<!-- INPUT FIELDS -->
  <div class="row">
    <p>Date Range 1</p>
    <div class="col-2">
      <% if params['range_1_date_1'].present? %>
        <%= text_field_tag "id", '', class: "range_1_date_1_field form-control", placeholder: 'Day 1', value: params['range_1_date_1'] %><br>
      <% else %>
        <%= text_field_tag "id", '', class: "range_1_date_1_field form-control", placeholder: 'Day 1' %><br>
      <% end %>
    </div>
    <div class="col-2">
      <% if params['range_1_date_2'].present? %>
        <%= text_field_tag "id", '', class: "range_1_date_2_field form-control", placeholder: 'Day 2', value: params['range_1_date_2'] %><br>
      <% else %>
        <%= text_field_tag "id", '', class: "range_1_date_2_field form-control", placeholder: 'Day 2' %><br>
      <% end %>
    </div>
  </div>
  <div class="row">
    <p>Date Range 2</p>
    <div class="col-2">
      <% if params['range_2_date_1'].present? %>
        <%= text_field_tag "id", '', class: "range_2_date_1_field form-control", placeholder: 'Day 1', value: params['range_2_date_1'] %><br>
      <% else %>
        <%= text_field_tag "id", '', class: "range_2_date_1_field form-control", placeholder: 'Day 1' %><br>
      <% end %>
    </div>
    <div class="col-2">
      <% if params['range_2_date_2'].present? %>
        <%= text_field_tag "id", '', class: "range_2_date_2_field form-control", placeholder: 'Day 2', value: params['range_2_date_2'] %><br>
      <% else %>
        <%= text_field_tag "id", '', class: "range_2_date_2_field form-control", placeholder: 'Day 2' %><br>
      <% end %>
    </div>
  </div>
<!-- END INPUT FIELDS -->
<!-- CAMPAIGN BUTTONS -->
  <% if params['co'] == 'sequoia' %>
    <%= link_to 'CPA RC', mktg_exports_path(co: 'sequoia', campaign: 'Return Customer', des: 'cpa'), class: 'w100 search_link btn btn-sm btn-primary text-light bg-gradient' %>
    <%= link_to 'EA RC', mktg_exports_path(co: 'sequoia', campaign: 'Return Customer', des: 'ea'), class: 'w100 search_link btn btn-sm btn-primary text-light bg-gradient' %>
    <%= link_to 'CPA NM', mktg_exports_path(co: 'sequoia', campaign: 'New Customer', des: 'cpa'), class: 'w100 search_link btn btn-sm btn-primary text-light bg-gradient' %>
    <%= link_to 'EA NM', mktg_exports_path(co: 'sequoia', campaign: 'New Customer', des: 'ea'), class: 'w100 search_link btn btn-sm btn-primary text-light bg-gradient' %>
  <% elsif params['co'] == 'empire' %>
    'NY Email'
  <% end %>
<!-- END CAMPAIGN BUTTONS -->

<br>
<h6 class="text-center text-success fw-bold"><%= @dates.present? ? "New dates displayed: #{(@dates.uniq.map{ |date| date.strftime("%Y-%m-%d") }).join(', ')}" : '' %></h6>
<table class="table table-striped">
<thead>
<caption class="caption-top">Total Records: <%= number_with_delimiter(MktgExport.count) %> | Display Limit: 100</caption>
<tr class="bg-secondary bg-gradient text-light">
      <th>Uid</th>
      <th>Campaign</th>
      <th>Des</th>
      <th><%= params['campaign'].present? && params['campaign'] == 'New Customer' ? 'Purchase' : params['campaign'].present? && params['campaign'] == 'Return Customer' ? 'EXP' : 'Date' %></th>
      <th>Email</th>
      <th>Fname</th>
      <th>Lname</th>
      <th>Street 1</th>
      <th>Street 2</th>
      <th>City</th>
      <th>State</th>
      <th>Zip</th>
      <th>Text 1</th>
      <th>Text 2</th>
      <th>Text 3</th>
      <th>Text 4</th>
      <th>Text 5</th>
      <th>Text 6</th>
      <th>Text 7</th>
      <th>Text 8</th>
      <th>Text 9</th>
      <th>Text 10</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @mktg_exports.order(exp: :asc).order(uid: :asc).each do |mktg_export| %>
      <tr>
        <td><%= mktg_export.uid %></td>
        <td><%= mktg_export.campaign %></td>
        <td><%= mktg_export.des %></td>
        <td><%= mktg_export.exp %></td>
        <td><%= mktg_export.email %></td>
        <td><%= mktg_export.fname %></td>
        <td><%= mktg_export.lname %></td>
        <td><%= mktg_export.street_1 %></td>
        <td><%= mktg_export.street_2 %></td>
        <td><%= mktg_export.city %></td>
        <td><%= mktg_export.state %></td>
        <td><%= mktg_export.zip %></td>
        <td><%= mktg_export.text_1 %></td>
        <td><%= mktg_export.text_2 %></td>
        <td><%= mktg_export.text_3 %></td>
        <td><%= mktg_export.text_4 %></td>
        <td><%= mktg_export.text_5 %></td>
        <td><%= mktg_export.text_6 %></td>
        <td><%= mktg_export.text_7 %></td>
        <td><%= mktg_export.text_8 %></td>
        <td><%= mktg_export.text_9 %></td>
        <td><%= mktg_export.text_10 %></td>
        <td><%= link_to 'Show', mktg_export %></td>
        <td><%= link_to 'Edit', edit_mktg_export_path(mktg_export) %></td>
        <td><%= link_to 'Destroy', mktg_export, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>

<script type="text/javascript">
  $(".search_link").click(function() {
    $(this).attr("href", function() {
      return this.href + "&range_1_date_1=" + $('.range_1_date_1_field').val() + "&range_1_date_2=" + $('.range_1_date_2_field').val() + "&range_2_date_1=" + $('.range_2_date_1_field').val() + "&range_2_date_2=" + $('.range_2_date_2_field').val();
      // return this.href + "?zip=" + $('.zip_field').val() + "&lname=" + $('.lname_field').val().toUpperCase() + "&state=" + $('.state_field').val().toUpperCase() + "&no_mail=find";
    });
  });
</script>
